- cve_id: CVE-2024-26643
  description: |-
    In the Linux kernel, the following vulnerability has been resolved:

    netfilter: nf_tables: mark set as dead when unbinding anonymous set with timeout

    While the rhashtable set gc runs asynchronously, a race allows it to
    collect elements from anonymous sets with timeouts while it is being
    released from the commit path.

    Mingi Cho originally reported this issue in a different path in 6.1.x
    with a pipapo set with low timeouts which is not possible upstream since
    7395dfacfff6 ("netfilter: nf_tables: use timestamp to check for set
    element timeout").

    Fix this by setting on the dead flag for anonymous sets to skip async gc
    in this case.

    According to 08e4c8c5919f ("netfilter: nf_tables: mark newset as dead on
    transaction abort"), Florian plans to accelerate abort path by releasing
    objects via workqueue, therefore, this sets on the dead flag for abort
    path too.
  severity: medium
  pattern:
    type: manual
    note: This signature requires manual review and pattern definition. See IMPLEMENTATION_PLAN.md section 2.4 for pattern types.
  references:
  - https://nvd.nist.gov/vuln/detail/CVE-2024-26643
  - https://git.kernel.org/stable/c/552705a3650bbf46a22b1adedc1b04181490fc36
  - https://git.kernel.org/stable/c/291cca35818bd52a407bc37ab45a15816039e363
  - https://git.kernel.org/stable/c/406b0241d0eb598a0b330ab20ae325537d8d8163
  - https://git.kernel.org/stable/c/5224afbc30c3ca9ba23e752f0f138729b2c48dd8
  - https://git.kernel.org/stable/c/b2d6f9a5b1cf968f1eaa71085ceeb09c2cb276b1
