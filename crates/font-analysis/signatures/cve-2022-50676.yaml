- cve_id: CVE-2022-50676
  description: |-
    In the Linux kernel, the following vulnerability has been resolved:

    net: rds: don't hold sock lock when cancelling work from rds_tcp_reset_callbacks()

    syzbot is reporting lockdep warning at rds_tcp_reset_callbacks() [1], for
    commit ac3615e7f3cffe2a ("RDS: TCP: Reduce code duplication in
    rds_tcp_reset_callbacks()") added cancel_delayed_work_sync() into a section
    protected by lock_sock() without realizing that rds_send_xmit() might call
    lock_sock().

    We don't need to protect cancel_delayed_work_sync() using lock_sock(), for
    even if rds_{send,recv}_worker() re-queued this work while __flush_work()
     from cancel_delayed_work_sync() was waiting for this work to complete,
    retried rds_{send,recv}_worker() is no-op due to the absence of RDS_CONN_UP
    bit.
  severity: medium
  pattern:
    type: manual
    note: This signature requires manual review and pattern definition. See IMPLEMENTATION_PLAN.md section 2.4 for pattern types.
  references:
  - https://git.kernel.org/stable/c/2425007c0967a7c04b0dee7cce05ecf0ca869ad1
  - https://git.kernel.org/stable/c/30bfa5aa7228eb1e67663d67e553627e572cc717
  - https://git.kernel.org/stable/c/5d2ba255e93211e541373469dffbda7c99dfa0e5
  - https://nvd.nist.gov/vuln/detail/CVE-2022-50676
  - https://git.kernel.org/stable/c/a91b750fd6629354460282bbf5146c01b05c4859
  - https://git.kernel.org/stable/c/360aa7219285fac63dab99706a16f2daf3222abe
