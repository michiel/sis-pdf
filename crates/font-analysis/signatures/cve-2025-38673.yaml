- cve_id: CVE-2025-38673
  description: |-
    In the Linux kernel, the following vulnerability has been resolved:

    Revert "drm/gem-framebuffer: Use dma_buf from GEM object instance"

    This reverts commit cce16fcd7446dcff7480cd9d2b6417075ed81065.

    The dma_buf field in struct drm_gem_object is not stable over the
    object instance's lifetime. The field becomes NULL when user space
    releases the final GEM handle on the buffer object. This resulted
    in a NULL-pointer deref.

    Workarounds in commit 5307dce878d4 ("drm/gem: Acquire references on
    GEM handles for framebuffers") and commit f6bfc9afc751 ("drm/framebuffer:
    Acquire internal references on GEM handles") only solved the problem
    partially. They especially don't work for buffer objects without a DRM
    framebuffer associated.

    Hence, this revert to going back to using .import_attach->dmabuf.

    v3:
    - cc stable
  severity: medium
  pattern:
    type: manual
    note: This signature requires manual review and pattern definition. See IMPLEMENTATION_PLAN.md section 2.4 for pattern types.
  references:
  - https://git.kernel.org/stable/c/2712ca878b688682ac2ce02aefc413fc76019cd9
  - https://git.kernel.org/stable/c/e31f5a1c2cd38bf977736cdfa79444e19d4005ec
  - https://nvd.nist.gov/vuln/detail/CVE-2025-38673
